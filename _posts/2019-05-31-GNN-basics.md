---
layout: article
title: GNN 教程：Graph 基础知识介绍
key: GNN_tutorial_basics
tags: GNN
category: blog
pageview: true
date: 2019-05-31 12:00:00 +08:00
---
## 引言

科学研究中并不是所有的数据都能够被转换到欧几里得空间中（eg：社交网络、信息网络等），导致无法有效地对这些数据进行处理。针对该问题，研究者们引入了图论中抽象意义上的图（Graph）来表示非欧几里得结构化数据。

本文首先分别介绍了欧几里得结构化数据和非欧几里得结构化数据特点，然后针对非欧几里得结构化数据的表示问题，引入了图论中抽象意义上的图（Graph）概念，并对图（Graph）中一些表示形式进行介绍，以帮助读者对图（Graph）这个概念做一定程度上的了解。

## 一、欧几里得结构化数据

### 1、欧几里得空间

欧几里德空间(Euclidean Space)，简称为欧氏空间(也可以称为平直空间)，在数学中是对欧几里德所研究的2维和3维空间的一般化。这个一般化把欧几里德对于距离、以及相关的概念长度和角度，转换成任意数维的坐标系。如下图所示。

![euclidean space](http://ww4.sinaimg.cn/large/006tNc79ly1g46vmxsp95j30lu0b3adf.jpg)

> 图 a 表示二维欧几里得空间

> 图 b 表示三维欧几里得空间

### 2、 常见的欧几里得结构化数据

将数据转换到欧几里得空间中，所得到的数据称为**欧几里得结构化数据**。

常见的欧几里得结构化数据主要包含：

- 1D：声音，时间序列等；
- 2D：图像等；
- 3D：视频，高光谱图像等；

![euclidean space data](http://ww4.sinaimg.cn/large/006tNc79ly1g46vmukxctj30l8090q5a.jpg)

## 二、非欧几里得结构化数据

### 1、非欧几里得空间

然而，科学研究中并不是所有的数据都能够被转换到欧几里得空间中（eg：社交网络、信息网络等），对于不能进行欧几里得结构化的数据，我们将其称为非欧几里得结构化数据。

### 2、 非常见的欧几里得结构化数据

常见的非欧几里得结构化数据主要包含：

- 1D：社交网络（eg：Facebook，Twitter等）等；
- 2D：生物网络（基因，分子，大脑连接）等；
- 3D：基础设施网络（eg：能源，交通，互联网，通信等）等；

![no euclidean space data](http://ww1.sinaimg.cn/large/006tNc79ly1g46vm87j37j30r807841t.jpg)

## 三、图（Graph）

### 1、图（Graph）的引入

针对非欧几里得结构化数据表示问题，研究者们引入了图论中抽象意义上的图（Graph）来表示非欧几里得结构化数据。

### 2、图（Graph）的定义

图（Graph）定义形式为$$\mathcal{G}=(\mathcal{V}, \mathcal{E})$$，其结构如下图所示：

![graph](http://ww3.sinaimg.cn/large/006tNc79ly1g46vmn1lj8j30c8083q30.jpg)

> 一个有标号的简单图，点集$$\mathcal{V}= \{1, 2, 3, 4, 5, 6\}$$，边集$$\mathcal{E} = \{\{1,2\}, \{1,5\}, \{2,3\}, \{2,5\}, \{3,4\}, \{4,5\}, \{4,6\}\}$$

$$\mathcal{V}=\left\{v_{i} \vert i=1, \ldots, N\right\}$$ 表示顶点或节点, 其中$N$表示节点的个数。
$$\mathcal{E}=\left\{e_{i j} \vert v_{i}, v_{j} \in \mathcal{V}\right\},\vert\mathcal{E}\vert \leq N^{2}$$ 表示顶点与顶点之间所连接的边；

### 3、图（Graph）的表示形式

#### (1)、邻接矩阵（Adjacency matrix）

邻接矩阵是一个元素为bool值或权值的$N\times N$矩阵，该矩阵的定义如下：

$$A \in \mathbb{R}^{N \times N}, A_{i j}=\left\{\begin{array}{cc}{a_{i j} \neq 0} & {e_{i j} \in \mathcal{E}} \\ {0,} & {\text { otherwise }}\end{array}\right.$$

若图中存在一条连接顶点$v_i$和$v_j$的边$e_{i j}$，则$a_{i j} \neq 0$,否则为0。当图是稠密时，邻接矩阵是比较合适的表达方法。如下图所示：

```c++
+---+---+---+---+---+---+---+
|   | 1 | 2 | 3 | 4 | 5 | 6 |
+---+---+---+---+---+---+---+
| 1 | 0 | 1 | 0 | 0 | 1 | 0 |
+---+---+---+---+---+---+---+
| 2 | 1 | 0 | 1 | 0 | 0 | 0 |
+---+---+---+---+---+---+---+
| 3 | 0 | 1 | 0 | 1 | 0 | 0 |
+---+---+---+---+---+---+---+
| 4 | 0 | 0 | 1 | 0 | 1 | 1 |
+---+---+---+---+---+---+---+
| 5 | 1 | 0 | 0 | 1 | 0 | 0 |
+---+---+---+---+---+---+---+
| 6 | 0 | 0 | 0 | 1 | 0 | 0 |
+---+---+---+---+---+---+---+
```

> 上图的邻接矩阵表示

#### (2)、度矩阵（ Degree matrix）

度矩阵（ Degree matrix）是一个 $D_{i,i}$ 为节点$v_i$的度的对角矩阵，其定义如下所示：
$$
D \in \mathbb{R}^{N \times N}, D_{i i}=\sum_{j} A_{i j}
$$

```c++
+---+---+---+---+---+---+---+
|   | 1 | 2 | 3 | 4 | 5 | 6 |
+---+---+---+---+---+---+---+
| 1 | 2 |   |   |   |   |   |
+---+---+---+---+---+---+---+
| 2 |   | 3 |   |   |   |   |
+---+---+---+---+---+---+---+
| 3 |   |   | 2 |   |   |   |
+---+---+---+---+---+---+---+
| 4 |   |   |   | 3 |   |   |
+---+---+---+---+---+---+---+
| 5 |   |   |   |   | 3 |   |
+---+---+---+---+---+---+---+
| 6 |   |   |   |   |   | 1 |
+---+---+---+---+---+---+---+
```

> 上图的度矩阵表示

#### (3)、邻域（ Neighborhood）

邻域（ Neighborhood） 表示与某个顶点有边连接的点集，其定义如下所示：
$$
\mathcal{N}\left(v_{i}\right)=\left\{v_{j} | e_{i j} \in \mathcal{E}\right\}
$$
例如，节点$1$的领域为$$\{2, 5\}$$

## 四、图上的学习任务

介绍完图的基本术语之后，我们来看看有了图结构数据，我们可以进行哪些机器学习的任务

- 图节点分类任务：图中每个节点都有对应的特征，当我们已知一些节点的类别的时候，可以设计分类任务针对未知节点进行分类。我们接下来要介绍的 GCN、GraphSAGE、GAT模型都是对图上的节点分类。
- 图的分类：对于整个图来说，我们也可以对图分类，图分类又称为图的同构问题，基本思路是将图中节点的特征聚合起来作为图的特征，再进行分类。

